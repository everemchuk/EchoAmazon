---
import App from "@app/App.astro";
import Logo from "@shared/ui/Logo/Logo.astro";
import Button from "@shared/ui/Button/Button.astro";
---

<App title="EchoAmazon - Home" activePage="home">
	<div class="container">
		<div class="logo-container">
			<Logo />
		</div>
		<h1>Welcome to EchoAmazon</h1>
		<p>Experience the future of shopping.</p>
		<Button id="theme-toggle" class="theme-toggle-btn" text="Toggle Theme" variant="sharp" color="primary" />
	</div>
</App>

<script>
	function initThemeToggle() {
		const toggleButton = document.getElementById("theme-toggle");
		const htmlElement = document.documentElement;

		if (!toggleButton) return;

		// Clone to strip existing listeners
		const newBtn = toggleButton.cloneNode(true);
		toggleButton.parentNode?.replaceChild(newBtn, toggleButton);
		const activeBtn = document.getElementById("theme-toggle");

		activeBtn?.addEventListener("click", () => {
			const currentTheme = htmlElement.getAttribute("data-theme");
			const newTheme = currentTheme === "dark" ? "light" : "dark";
			htmlElement.setAttribute("data-theme", newTheme);
			localStorage.setItem("theme", newTheme);
		});
	}

	// Run only on astro:page-load (handles initial load + transitions)
	document.addEventListener("astro:page-load", initThemeToggle);
</script>

<style lang="sass">
	@use '@shared/styles/vars' as *

	.container
		display: flex
		flex-direction: column
		align-items: center
		justify-content: center
		min-height: 80vh
		text-align: center
		padding: 1rem

		@include respond-to($tablet)
			padding: 2rem

	.logo-container
		width: 150px
		margin-bottom: 1rem

		@include respond-to($tablet)
			width: 200px
			margin-bottom: 2rem

	h1
		font-family: $font-family-heading
		font-size: 2rem
		margin-bottom: 0.5rem
		color: var(--primary-color)

		@include respond-to($tablet)
			font-size: 3rem
			margin-bottom: 1rem

	p
		font-size: 1rem

		@include respond-to($tablet)
			font-size: 1.25rem

	.theme-toggle-btn
		margin-top: 1.5rem

		@include respond-to($tablet)
			margin-top: 2rem
</style>
